# Diagrama do Fluxo de InstalaÃ§Ã£o AutomÃ¡tica

## ğŸ“Š Fluxo de ExecuÃ§Ã£o Completo

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   TERRAFORM APPLY                                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 1. Provisiona 4 VMs na OCI (Master + 3 Workers)                         â”‚
â”‚ 2. Configura Network (VPC, Subnet, Security Rules)                      â”‚
â”‚ 3. Executa InstallMaster.sh via user_data                               â”‚
â”‚ 4. Executa InstallWorker.sh via user_data                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â”‚ (2-3 minutos)
               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              INSTALAÃ‡ÃƒO DO SO & AMBARI (Scripts)                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ MASTER:                                                                  â”‚
â”‚ âœ“ Oracle Linux 9                                                         â”‚
â”‚ âœ“ Java 1.8.0                                                             â”‚
â”‚ âœ“ PostgreSQL                                                             â”‚
â”‚ âœ“ Ambari Server                                                          â”‚
â”‚ âœ“ Ambari Agent                                                           â”‚
â”‚ âœ“ ODP repos 1.2.2.0-128                                                  â”‚
â”‚                                                                          â”‚
â”‚ WORKERS (node1, node2, node3):                                           â”‚
â”‚ âœ“ Oracle Linux 9                                                         â”‚
â”‚ âœ“ Java 1.8.0                                                             â”‚
â”‚ âœ“ Ambari Agent                                                           â”‚
â”‚ âœ“ ODP repos 1.2.2.0-128                                                  â”‚
â”‚ âœ“ Conectam ao Master:2181                                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â”‚ (1-2 minutos)
               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         STEP 1: VALIDAÃ‡ÃƒO DE PRÃ‰-REQUISITOS                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ validate-prerequisites.sh:                                               â”‚
â”‚ âœ“ Ambari Server rodando?                                                 â”‚
â”‚ âœ“ PostgreSQL rodando?                                                     â”‚
â”‚ âœ“ SSH conecta aos workers?                                               â”‚
â”‚ âœ“ Agentes respondendo?                                                    â”‚
â”‚ âœ“ DNS resolvendo?                                                         â”‚
â”‚ âœ“ Arquivos blueprint.json e cluster-template.json existem?               â”‚
â”‚                                                                          â”‚
â”‚ Status: PASS âœ“ ou FAIL âœ—                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â”‚ (5-10 minutos)
               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         STEP 2: AGUARDAR REGISTRO DE HOSTS                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ register-hosts.sh:                                                       â”‚
â”‚                                                                          â”‚
â”‚ Ambari Server                          Ambari Agents                    â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”‚
â”‚ â”‚ master.cdp:8080       â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚ node1.cdp    â”‚                 â”‚
â”‚ â”‚ (Server)              â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚ (Agent)      â”‚                 â”‚
â”‚ â”‚                       â”‚             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â”‚
â”‚ â”‚ Hosts encontrados: 4  â”‚             â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”‚
â”‚ â”‚ âœ“ master.cdp          â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚ node2.cdp    â”‚                 â”‚
â”‚ â”‚ âœ“ node1.cdp           â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚ (Agent)      â”‚                 â”‚
â”‚ â”‚ âœ“ node2.cdp           â”‚             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â”‚
â”‚ â”‚ âœ“ node3.cdp           â”‚             â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”‚
â”‚ â”‚                       â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚ node3.cdp    â”‚                 â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚ (Agent)      â”‚                 â”‚
â”‚                                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â”‚
â”‚ Status: 4/4 Hosts âœ“                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â”‚ (1-2 minutos)
               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         STEP 3: REGISTRAR BLUEPRINT                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ apply-blueprint.sh (PARTE 1):                                            â”‚
â”‚                                                                          â”‚
â”‚ POST /api/v1/blueprints/default                                         â”‚
â”‚ Content-Type: application/json                                          â”‚
â”‚ Body: blueprint.json (441KB)                                             â”‚
â”‚                                                                          â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚ â”‚ Blueprint Contents:                                               â”‚   â”‚
â”‚ â”‚ {                                                                 â”‚   â”‚
â”‚ â”‚   \"Blueprints\": { \"blueprint_name\": \"default\" },             â”‚   â”‚
â”‚ â”‚   \"host_groups\": [                                              â”‚   â”‚
â”‚ â”‚     {                                                             â”‚   â”‚
â”‚ â”‚       \"name\": \"host_group_1\",                                 â”‚   â”‚
â”‚ â”‚       \"components\": [                                           â”‚   â”‚
â”‚ â”‚         \"ZOOKEEPER_SERVER\", \"NAMENODE\", \"DATANODE\",         â”‚   â”‚
â”‚ â”‚         \"SECONDARY_NAMENODE\", \"RESOURCEMANAGER\",              â”‚   â”‚
â”‚ â”‚         \"NODEMANAGER\", \"HIVE_METASTORE\", \"HIVESERVER2\",      â”‚   â”‚
â”‚ â”‚         \"SPARK_CLIENT\", \"KAFKA_BROKER\", ...                  â”‚   â”‚
â”‚ â”‚       ]                                                           â”‚   â”‚
â”‚ â”‚     },                                                            â”‚   â”‚
â”‚ â”‚     { \"name\": \"host_group_2\", ... }                           â”‚   â”‚
â”‚ â”‚   ],                                                              â”‚   â”‚
â”‚ â”‚   \"configurations\": [ ... ]  (200+ configuraÃ§Ãµes)               â”‚   â”‚
â”‚ â”‚ }                                                                 â”‚   â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                          â”‚
â”‚ Resposta: HTTP 201 Created âœ“                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â”‚ (1 minuto)
               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         STEP 4: CRIAR CLUSTER COM TEMPLATE                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ apply-blueprint.sh (PARTE 2):                                            â”‚
â”‚                                                                          â”‚
â”‚ POST /api/v1/clusters/cdp-cluster                                       â”‚
â”‚ Content-Type: application/json                                          â”‚
â”‚ Body: cluster-template.json                                              â”‚
â”‚                                                                          â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚ â”‚ Template Contents:                                                â”‚   â”‚
â”‚ â”‚ {                                                                 â”‚   â”‚
â”‚ â”‚   \"blueprint\": \"default\",                                      â”‚   â”‚
â”‚ â”‚   \"default_password\": \"AmbariPassword123!\",                   â”‚   â”‚
â”‚ â”‚   \"host_groups\": [                                              â”‚   â”‚
â”‚ â”‚     {                                                             â”‚   â”‚
â”‚ â”‚       \"name\": \"host_group_1\",                                 â”‚   â”‚
â”‚ â”‚       \"hosts\": [                                                â”‚   â”‚
â”‚ â”‚         {\"fqdn\": \"master.cdp\"},                                â”‚   â”‚
â”‚ â”‚         {\"fqdn\": \"node1.cdp\"},                                 â”‚   â”‚
â”‚ â”‚         {\"fqdn\": \"node2.cdp\"},                                 â”‚   â”‚
â”‚ â”‚         {\"fqdn\": \"node3.cdp\"}                                  â”‚   â”‚
â”‚ â”‚       ]                                                           â”‚   â”‚
â”‚ â”‚     }                                                             â”‚   â”‚
â”‚ â”‚   ]                                                               â”‚   â”‚
â”‚ â”‚ }                                                                 â”‚   â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                          â”‚
â”‚ Resposta: HTTP 202 Accepted (instalaÃ§Ã£o iniciada!)                      â”‚
â”‚ Request ID: 1                                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â”‚ (20-40 minutos - PROGRESSO A SEGUIR)
               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         STEP 5: INSTALAR SERVIÃ‡OS (CORE)                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ monitor-deployment.sh - Progresso 0-30%:                                 â”‚
â”‚                                                                          â”‚
â”‚ [00:00] Distribuindo JDK aos hosts                   (1-2 min)          â”‚
â”‚ [02:00] Instalando Zookeeper                         (2-3 min)          â”‚
â”‚ [05:00] Formatando HDFS                              (1 min)            â”‚
â”‚ [06:00] Inicializando HDFS                           (2-3 min)          â”‚
â”‚ [08:00] Instalando Yarn ResourceManager              (2 min)            â”‚
â”‚ [10:00] Instalando Yarn NodeManagers                 (2-3 min)          â”‚
â”‚                                                                          â”‚
â”‚ Progress: â–“â–“â–“â–“â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘ 30%                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â”‚ (10 minutos)
               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         STEP 6: INSTALAR SERVIÃ‡OS (DATA)                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ monitor-deployment.sh - Progresso 30-60%:                                â”‚
â”‚                                                                          â”‚
â”‚ [15:00] Instalando HBase                             (3-4 min)          â”‚
â”‚ [19:00] Instalando Hive Metastore                    (2 min)            â”‚
â”‚ [21:00] Inicializando Hive database                  (1 min)            â”‚
â”‚ [22:00] Instalando Kafka                             (2-3 min)          â”‚
â”‚ [25:00] Instalando Spark3 History Server             (2 min)            â”‚
â”‚ [27:00] Instalando Livy Server                       (2 min)            â”‚
â”‚                                                                          â”‚
â”‚ Progress: â–“â–“â–“â–“â–“â–“â–“â–“â–“â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘ 60%                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â”‚ (10 minutos)
               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         STEP 7: INSTALAR SERVIÃ‡OS (SEGURANÃ‡A & ADMIN)                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ monitor-deployment.sh - Progresso 60-90%:                                â”‚
â”‚                                                                          â”‚
â”‚ [32:00] Instalando Ranger Admin                      (3-5 min)          â”‚
â”‚ [37:00] Instalando Atlas                             (2-3 min)          â”‚
â”‚ [40:00] Instalando NiFi                              (2-3 min)          â”‚
â”‚ [43:00] Instalando Ambari Metrics                    (2 min)            â”‚
â”‚ [45:00] Configurando serviÃ§os                        (3-5 min)          â”‚
â”‚                                                                          â”‚
â”‚ Progress: â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–‘â–‘â–‘â–‘â–‘â–‘ 90%                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â”‚ (5-10 minutos)
               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         STEP 8: FINALIZAR (INIT DOS SERVIÃ‡OS)                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ monitor-deployment.sh - Progresso 90-100%:                               â”‚
â”‚                                                                          â”‚
â”‚ [50:00] Iniciando todos os serviÃ§os                  (3-5 min)          â”‚
â”‚ [55:00] Verificando status                           (2 min)            â”‚
â”‚ [57:00] Finalizando instalaÃ§Ã£o                       (1-2 min)          â”‚
â”‚                                                                          â”‚
â”‚ Progress: â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“ 100% âœ“                                     â”‚
â”‚                                                                          â”‚
â”‚ Request Status: COMPLETED                                                â”‚
â”‚ All tasks: SUCCESS                                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â”‚ (instantÃ¢neo)
               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         âœ… SUCESSO - CLUSTER PRONTO!                                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Dashboard: http://master-ip:8080                                        â”‚
â”‚ UsuÃ¡rio: admin                                                           â”‚
â”‚ Senha: admin                                                             â”‚
â”‚                                                                          â”‚
â”‚ ServiÃ§os Instalados:                                                     â”‚
â”‚ âœ“ HDFS (NameNode, DataNodes)                                             â”‚
â”‚ âœ“ YARN (ResourceManager, NodeManagers)                                   â”‚
â”‚ âœ“ Zookeeper                                                              â”‚
â”‚ âœ“ HBase                                                                  â”‚
â”‚ âœ“ Hive                                                                   â”‚
â”‚ âœ“ Spark3                                                                 â”‚
â”‚ âœ“ Kafka                                                                  â”‚
â”‚ âœ“ NiFi                                                                   â”‚
â”‚ âœ“ Ranger                                                                 â”‚
â”‚ âœ“ Atlas                                                                  â”‚
â”‚ âœ“ Livy                                                                   â”‚
â”‚ ... e muitos mais!                                                       â”‚
â”‚                                                                          â”‚
â”‚ Status no Dashboard:                                                     â”‚
â”‚ â”œâ”€â”€ HDFS: STARTED âœ“                                                      â”‚
â”‚ â”œâ”€â”€ YARN: STARTED âœ“                                                      â”‚
â”‚ â”œâ”€â”€ HBASE: STARTED âœ“                                                     â”‚
â”‚ â”œâ”€â”€ HIVE: STARTED âœ“                                                      â”‚
â”‚ â”œâ”€â”€ SPARK3: STARTED âœ“                                                    â”‚
â”‚ â”œâ”€â”€ KAFKA: STARTED âœ“                                                     â”‚
â”‚ â”œâ”€â”€ NIFI: STARTED âœ“                                                      â”‚
â”‚ â”œâ”€â”€ RANGER: STARTED âœ“                                                    â”‚
â”‚ â”œâ”€â”€ ATLAS: STARTED âœ“                                                     â”‚
â”‚ â”œâ”€â”€ LIVY: STARTED âœ“                                                      â”‚
â”‚ â””â”€â”€ ZOOKEEPER: STARTED âœ“                                                 â”‚
â”‚                                                                          â”‚
â”‚ PrÃ³ximas AÃ§Ãµes:                                                          â”‚
â”‚ 1. Acessar UI Ambari                                                     â”‚
â”‚ 2. Verificar componentes                                                 â”‚
â”‚ 3. Testar serviÃ§os (HDFS, YARN, Hive, etc)                               â”‚
â”‚ 4. Configurar seguranÃ§a (Ranger, Kerberos)                               â”‚
â”‚ 5. Setup de monitoramento (Grafana, Prometheus)                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”„ ComparaÃ§Ã£o: Antes vs Depois

### ANTES (Manual - Seu processo atual)

```
Dia 1:
â”œâ”€ 09:00 - Executar terraform apply
â”œâ”€ 10:00 - Esperar VMs
â”œâ”€ 10:30 - Esperar SO + Ambari
â”œâ”€ 11:00 - Acessar UI Ambari http://10.0.0.2:8080
â”œâ”€ 11:05 - Importar blueprint manualmente
â”œâ”€ 11:10 - Criar cluster manualmente
â”œâ”€ 11:15 - Configurar hosts manualmente
â”œâ”€ 11:30 - Clicar em Install
â”‚   ...
â”‚   PARADO AQUI - esperando...
â”‚   ...
â”œâ”€ 12:30 - Voltar e clicar em botÃµes
â””â”€ 13:00+ - Esperar

Dia 2:
â”œâ”€ 09:00 - Voltar e verificar progresso
â”œâ”€ 10:00 - Resolver erros manualmente
â””â”€ 11:00 - Cluster pronto (talvez)

TEMPO TOTAL: 2 dias + 5+ horas de cliques
```

### DEPOIS (AutomÃ¡tico - Seu novo processo)

```
Dia 1:
â”œâ”€ 09:00 - Executar terraform apply
â”œâ”€ 10:00 - Esperar VMs + bash quick-deploy.sh
â”‚   (completamente automÃ¡tico)
â”‚   ...
â”‚   Progress: â–“â–“â–“â–“â–“â–‘â–‘â–‘â–‘â–‘â–‘ 50% 
â”‚   Progress: â–“â–“â–“â–“â–“â–“â–“â–“â–“â–‘â–‘ 90%
â”‚   Progress: â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“ 100% âœ“
â””â”€ 10:50 - Cluster pronto!

TEMPO TOTAL: 50 minutos + 0 cliques
```

---

## ğŸ”— Mapeamento de Componentes

```
Ambari API Calls:

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ validate-prerequisites.sh   â”‚ â”€â”€â†’ curl /api/v1/hosts
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    curl /api/v1/clusters
                                   ssh to workers

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ register-hosts.sh           â”‚ â”€â”€â†’ watch /api/v1/hosts
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    atÃ© 4 hosts aparecerem

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ apply-blueprint.sh          â”‚ â”€â”€â†’ POST /api/v1/blueprints/default
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    POST /api/v1/clusters/cdp-cluster

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ monitor-deployment.sh       â”‚ â”€â”€â†’ GET /api/v1/clusters/.../requests/1
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    jq para extrair progress
                                   sleep e loop
```

---

## ğŸ“ Tarefas por Arquivo

```
blueprint.json (vocÃª jÃ¡ tem)
  â”œâ”€ Define: Quais serviÃ§os instalar
  â”œâ”€ Define: ConfiguraÃ§Ã£o de cada serviÃ§o
  â””â”€ Define: Host groups e alocaÃ§Ã£o

cluster-template.json (vocÃª precisa criar)
  â”œâ”€ Define: Nome do cluster
  â”œâ”€ Define: Hosts em cada host_group
  â””â”€ Define: Senhas padrÃ£o

Scripts (vocÃª precisa criar/adaptar)
  â”œâ”€ validate-prerequisites.sh
  â”‚   â””â”€ Valida ambiente antes de comeÃ§ar
  â”œâ”€ register-hosts.sh
  â”‚   â””â”€ Aguarda 4 hosts conectarem
  â”œâ”€ apply-blueprint.sh
  â”‚   â””â”€ Envia blueprint + cria cluster
  â”œâ”€ monitor-deployment.sh
  â”‚   â””â”€ Acompanha progresso atÃ© 100%
  â””â”€ quick-deploy.sh
      â””â”€ Executa tudo em sequÃªncia
```

---

**Diagrama VersÃ£o:** 1.0  
**PrÃ³xima Fase:** Scripts em ExecuÃ§Ã£o!